# 小白鼠试毒问题

### 一、问题：

现在有 1000 瓶药水，其中有 1 瓶毒药，毒药药性发作致死时间为 1 小时。现在有 1 个小时的时间找出毒药，那么至少需要多少只小白鼠来试毒？假设药水量无限，可以无限稀释，喝药时间不计。

### 二进制解法

这道题实际上是一个二进制问题。小白鼠喝了一定量的药水之后，只有两种状态，联想到就是二进制的 0 和 1。那么现在我们给这 1000 瓶药水用二进制标号，所有药水的编号可以由一个 10 位二进制数表示。由于喝药之后的小白鼠会有两种状态，分别代表 0 和 1，刚好可以表示二进制数的 1 位，所以最少需要 10 只小白鼠。

具体的操作方式如下：

1. 第 N 只小白鼠喝掉二进制编号第 N 位为 1 的所有药。比如第一只小白鼠喝掉所有编号符合 XXXXXXXXX1 的药。
2. 1 个小时后，对于第 N 只小白鼠，假设死亡，那么可以判断毒药编号的第 N 位为 1；如果未死亡则第 N 位为 0。
3. 以此类推，可以判断出毒药的二进制编号，即可以找出毒药。

##### 公式

总结来说，每只小白鼠能确定二进数的一位，那么 $$x$$ 只小白鼠就能确认 $$2^x$$ 瓶药水中的 1 瓶毒药。

换句话说，如果最初有 $$y$$ 瓶药水，需要的小白鼠数目 $$x = ceil(log_2 y)$$ 只。

### 信息论解法

根据信息论，假设一只小白鼠喝 $$t$$ 瓶药，那么这一只小白鼠死亡的概率为 $$n=\frac{t}{1000}$$ 能够获得的信息量为 $$H(n) = -nlog_2 (n) - (1-n)log_2(1-n)$$ 。容易证明 $$n=0.5$$ 时 $$H(n)$$ 最大，所以每只小白鼠喝 500 瓶药，获得的信息量最大。

接下来，1000 瓶中有 1 瓶毒药的信息量为 $$-log_2(\frac{1}{1000}) = log_2 1000$$，一只小白鼠的信息量为 $$-log_2(\frac{1}{2}) = 1$$ 。所以需要的小白鼠的数量 $$x = ceil(log_21000)$$

##### 公式

根据上述分析，可以知道 $$y$$ 瓶中有 1 瓶毒药的信息为量 $$-log_2(\frac{1}{y}) = log_2 y$$，一只小白鼠的信息量为 $$-log_2(\frac{1}{2}) = 1$$ 。所以需要小白鼠的数量 $$x = ceil(log_2y)$$ 只。



### 二、问题变体：

现在毒药的药性改变，会在 15 分钟之内发作。其他条件不变，1 个小时的时间，请问需要多少只小白鼠？

### 二进制解法

由于毒药 15 分钟发作，小白鼠采用的策略的是每隔 15 分钟喝 1 瓶毒药（如果这 15 分钟小白鼠没死，分别是第0、15、30、45 分钟时）。那么实际上就是 5 进制，小白鼠每隔 15 分钟喝药之后，在 1 个小时之内有 4 个不同的死亡时间段，也可能不死，那么一共就有 5 种状态。按照 5 进制编号，一共需要 5 位 5 进制数。所以需要最少 5 只小白鼠。

具体操作如下：

1. 把药水按照 5 进制编号。第 N 只小白鼠在一个小时时间内，每隔 15 分钟分别喝掉对应位为 0、1、2、3的药水。比如第一只小白鼠在第 20 分钟，喝掉编号为 XXXX1 的药（如果还没死的话）。第 3 只小白鼠第50分钟喝掉编号为 XX3XX 的药（如果还没死的话）。

2. 如果在喝药之后 15分钟之内死亡，那么就说明毒药在对应编号的药。如果最终也没死，那么毒药是对应位为 4 的药。

3. 以此类推，可以判断出毒药五进制的对应编号，即可找出毒药。


##### 公式

类似的，最初有 $$y$$ 瓶药，那么需要小白鼠数量 $$x=ceil(log_5y)$$ 只。

### 信息论解法

由于毒药 15 分钟发作，小白鼠采用的策略的是每隔 15 分钟喝 1 瓶毒药（如果这 15 分钟小白鼠没死）。那么小白鼠可能死亡的时间段一共有 4 种，以及 1 种不死亡的情况。所以，一只小白鼠的信息量为 $$-log_2(\frac{1}{5})$$ 

接下来，1000 瓶中有 1 瓶毒药的信息量为 $$-log_2(\frac{1}{1000}) = log_2 1000$$，一只小白鼠的信息量为 $$-log_2(\frac{1}{5}) = log_2 5$$ 。所以需要的小白鼠的数量 $$x = ceil(\frac{log_21000}{log_25}) = 5$$